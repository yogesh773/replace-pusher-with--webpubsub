"use strict";
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.
Object.defineProperty(exports, "__esModule", { value: true });
exports.abortablePromise = abortablePromise;
const abort_controller_1 = require("@azure/abort-controller");
async function abortablePromise(promise, signal) {
    if (signal.aborted) {
        throw new abort_controller_1.AbortError("The operation was aborted.");
    }
    let onAbort;
    // eslint-disable-next-line promise/param-names
    const p = new Promise((_, reject) => {
        onAbort = () => {
            reject(new abort_controller_1.AbortError("The operation was aborted."));
        };
        signal.addEventListener("abort", onAbort);
    });
    try {
        return await Promise.race([promise, p]);
    }
    finally {
        signal.removeEventListener("abort", onAbort);
    }
}
//# sourceMappingURL=abortablePromise.js.map